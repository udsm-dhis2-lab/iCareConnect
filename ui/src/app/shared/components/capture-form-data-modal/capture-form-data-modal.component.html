<ng-container
  *ngIf="{
    form: form$ | async,
    provider: provider$ | async,
    visit: currentVisit$ | async,
    savingObservations: savingObservations$ | async,
    observations: observations$ | async
  } as params"
>
  <mat-progress-bar
    *ngIf="!params?.form || !params?.observations"
    mode="indeterminate"
  ></mat-progress-bar>
  <ng-container>
    <mat-toolbar color="primary">
      <span>{{ params?.form?.name }}</span>
      <span class="toolbar-spacer"></span>
      <button mat-icon-button mat-dialog-close matTooltip="close">
        <mat-icon>close</mat-icon>
      </button>
    </mat-toolbar>
    <mat-dialog-content *ngIf="params?.form && params?.observations">
      <app-capture-form-data
        [form]="params?.form"
        [observations]="params?.observations"
        (formDataUpdate)="onFormUpdate($event, params?.form)"
      ></app-capture-form-data>
    </mat-dialog-content>
    <mat-progress-bar
      *ngIf="!params?.form || !params?.observations"
      mode="indeterminate"
    ></mat-progress-bar>
    <mat-dialog-actions align="end">
      <button mat-stroked-button (click)="onClose($event)">Cancel</button>
      <button
        mat-flat-button
        color="primary"
        (click)="saveCurrentFormData($event)"
      >
        <mat-spinner
          color="primary"
          *ngIf="params?.savingObservations"
          [diameter]="20"
          style="display: inline-block !important; margin-right: 4px"
        ></mat-spinner>
        {{ savingObservations ? "Saving ..." : "Save" }}
      </button>
    </mat-dialog-actions>
  </ng-container>
</ng-container>
