<div
  class="submit-e-claim-container"
  *ngIf="{
    visitClaim: visitClaim$ | async,
    submitClaimResponse: submitClaimResponse$ | async
  } as params"
>
  <div
    class="loading-overlay"
    *ngIf="submittingClaim && !params?.submitClaimResponse"
  >
    <div class="text-center">
      <div>Submitting Claim</div>
      <div class="mt-3 d-flex justify-content-center w-100">
        <mat-spinner diameter="50" strokeWidth="2"></mat-spinner>
      </div>
    </div>
  </div>
  <mat-toolbar>
    <button
      mat-icon-button
      [routerLink]="'/e-claim'"
      matTooltip="Go to Clients List"
    >
      <mat-icon>arrow_back</mat-icon>
    </button>
    <span class="ml-2">Back to Patients List</span>
  </mat-toolbar>
  <mat-progress-bar
    mode="indeterminate"
    *ngIf="!params?.visitClaim"
  ></mat-progress-bar>
  <div class="e-claim-summary-container">
    <div class="claim-header-container">
      <h3 class="patient-name-title">
        {{ visitClaim.patientName }},
        <span class="demographics">
          ({{ visitClaim.gender }} | {{ visitClaim.age }} Yrs | {{ visitClaim.birthDate }})
        </span>
      </h3>
      <hr />
      <div class="row-info">
        <span><strong>MRN:</strong> {{ visitClaim.mrn }}</span>
        <span><strong>Phone:</strong> {{ visitClaim.phone }}</span>
        <span><strong>Email:</strong> {{ visitClaim.email || '-' }}</span>
        <span><strong>Payment type:</strong> {{ visitClaim.paymentType }}</span>
        <span><strong>Authorized NO.:</strong> {{ visitClaim.authorizationNo }}</span>
        <span><strong>Insurance ID:</strong> {{ visitClaim.insuranceId }}</span>
        <span><strong>PaymentScheme:</strong> {{ visitClaim.paymentScheme }}</span>
        <span><strong>Insurance:</strong> {{ visitClaim.insuranceName }}</span>
        <span class="room-info">
          <mat-icon inline style="font-size: 16px;">location_on</mat-icon>
          {{ visitClaim.room }}
        </span>
      </div>
    </div>
    

    <!-- Claim Items Table -->
    <table class="claim-table">
      <thead>
        <tr>
          <th>Service Category</th>
          <th>Service Details</th>
          <th>Cost</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of visitClaim.claimItems">
          <td>{{ item.category }}</td>
          <td>{{ item.serviceDetails.join(", ") }}</td>
          <td>{{ item.cost | number }}/=</td>
        </tr>
      </tbody>
      <tfoot>
        <tr>
          <th colspan="2" class="text-right">Total Cost</th>
          <th>{{ visitClaim.totalCost | number }}/=</th>
        </tr>
      </tfoot>
    </table>
  </div>

  <div class="alert alert-success" role="alert" *ngIf="claimSent">
    Claim submitted Successfully
  </div>
  <div class="d-flex justify-content-end p-2">
    <button mat-stroked-button class="mr-2" [routerLink]="'/e-claim'">
      {{ claimSent ? "Done" : "Cancel" }}
    </button>
    <button
      [disabled]="
        !params?.visitClaim?.claimFile || claimSent || submittingClaim
      "
      color="primary"
      (click)="onSubmitEClaim($event, visitUuid)"
      mat-stroked-button
    >
      Submit
    </button>
  </div>
</div>
